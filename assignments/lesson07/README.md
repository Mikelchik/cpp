# Практический урок по записи: HumanRated, Jupyter Playground и вызовы API

> Этот конспект помогает воспроизвести всё, что демонстрировалось на занятии: от создания бота в HumanRated/App‑Rated до настройки Jupyter‑Playground и тестовых запросов к API через `curl` и скрипт `test.sh`.


[Смотреть на YouTube](https://youtu.be/kvCvKQXxQO0)

---

## 0) Что вы получите в итоге
- Готовый бот на платформе HumanRated (его можно сделать публичным и «опенсорсным»).
- Доступ в Jupyter‑Playground (edu‑rated), где уже преднастроена среда.
- Рабочий API‑ключ, сохранённый в `key.txt` корректным способом (через терминал).
- Умение отправлять запросы к API с помощью `curl` и скрипта `test.sh`.

---

## 1) Коротко о платформе HumanRated / App‑Rated
- Платформа позволяет **создавать чат‑ботов** и делиться ими по ссылке.
- Интерфейс: список ботов, «+» (создать), «★» (избранное), «⚙ Настройки».
- Каждый бот может быть: **Private**, **Public** (виден другим), **Open Source** (промпты доступны всем).
- Для каждого бота задаются **три инструкции** (prefix, suffix и инструкция для анализа изображений) и **welcome‑сообщение**.

### Быстрый сценарий создания бота
1. Нажмите **«+»** и введите имя (частично латиницей) и описание (можно по‑русски).
2. Отметьте флажками при необходимости: **Public** и **Open Source**.
3. Включите опцию **автогенерации промптов** из описания и примените их (**Apply as prompts**).
4. Нажмите **Create / Save** — бот появится в списке.
5. В карточке бота используйте **Share** → получите URL для друзей/коллег.

> Пример учебного бота: *ProgrammerHelperBot* — «помогает с задачами, понимает код и изображения».

---

## 2) Jupyter‑Playground (edu‑rated): вход и ориентиры
### Регистрация и вход
1. **Sign Up** → задайте `username`, `email`, `password` (почта может быть не настроена, не забывайте пароль).
2. После регистрации **перейдите на страницу Login** и войдите.

### Навигация в интерфейсе
- **Слева** — файловая панель (есть read‑only папка с материалами, свои файлы создавайте рядом).
- **Справа** — **Launcher**: запуск ноутбуков (есть Python и **несколько C++‑ядер**), **Console**, **Terminal**.
- Терминал понадобится для подготовки ключа и утилитных команд.

---

## 3) Работа в терминале: базовые команды (с повторением)
- `uname -a` — сведения о системе.
- `ls` / `ls -l` — список файлов и атрибуты.
- `pwd` — текущий каталог.
- `cd work` — переход в учебную рабочую директорию.
- `cat FILE` — вывести содержимое файла.
- `which CMD` — поиск расположения команды (и мягкая проверка её наличия).

> В Jupyter‑контейнере учебные материалы размещены в каталоге `work/…`.

---

## 4) Создаём и наполняем `key.txt` корректно
**Почему не просто «вставить ключ»?** Чтобы не «подсветить» и не ошибиться копированием, создадим ключ терминальными командами.

### Шаги
1. В корне рабочей области (обычно это `work/`) создайте **пустой файл** `key.txt` (через правую кнопку → *New File* или через терминал):
   ```bash
   touch key.txt
   ```
2. Возьмём базовую строку (в демо это слово `edu`) и превратим её в **MD5‑хеш** длиной 32 символа без перевода строки:
   ```bash
   echo -n edu | md5sum
   ```
   > Ключом должен быть именно 32‑символьный хеш, а не «edu».
3. Обрежем вывод до первых 32 символов и **запишем** в `key.txt` (вариант через `cut`):
   ```bash
   echo -n edu | md5sum | cut -c -32 > key.txt
   ```
   Альтернативно (как в демо):
   ```bash
   echo -n edu | md5sum | cat -c 32 > key.txt
   ```
4. Убедимся, что в файле действительно один 32‑символьный токен:
   ```bash
   cat key.txt
   # должно быть что-то вроде: 379… (всего 32 символа)
   ```

> В реальной работе используйте **свой постоянный ключ** (не учебный). Запишите его в `key.txt` тем же способом.

---

## 5) Проверяем загрузку ключа в ноутбуке
В учебном C++/Python‑ноутбуке есть ячейка, которая читает `../../key.txt`, печатает «API key loaded» и маскирует середину ключа. Если раньше падала с «key.txt не найден», после шага 4 она пройдёт.

> В ноутбуках кнопка ▶︎ (или `Shift+Enter`) запускает текущую ячейку. Комментарии‑ячейки «проскальзывают», код — выполняется.

---

## 6) Отправляем тестовые запросы к API
### Вариант А: чистый `curl`
Самый простой GET‑запрос:
```bash
curl -L https://example.com
```

### Вариант Б: скрипт `test.sh`
1. Создайте файл `test.sh` и вставьте учебный шаблон (из репозитория/чата).
2. Сделайте его исполняемым:
   ```bash
   chmod +x test.sh
   ```
3. Запустите **без аргументов** — увидите справку по параметрам.
4. Типовой вызов (host, prompt, key):
   ```bash
   ./test.sh ai.api.hue.com "Hi" "$(cat key.txt)"
   ```
   - 1‑й аргумент — `host[:port]` (может быть `localhost` для локального сервера),
   - 2‑й — текст запроса (**кавычки обязательны**),
   - 3‑й — ключ (подставляем из файла через `$(cat key.txt)`, чтобы не раскрывать его в истории).

### Важные примечания по кавычкам
- **Одинарные** `'…'` — ничего не интерпретируют внутри.
- **Двойные** `"…"` — разрешают подстановку команд: 
  ```bash
  ./test.sh host "now is $(date). How are you?" "$(cat key.txt)"
  ```

Ожидаемый ответ — JSON с результатом генерации (значит, авторизация и маршрут до API настроены верно).

---

## 7) Демонстрация работы с изображениями/кодом
- В App‑Rated можно загрузить **скриншот фрагмента кода** (например, Dockerfile). Модель распознает контент и поясняет, что он делает.
- Бот можно «расширять»: делиться ссылкой, открывать промпты (если бот отмечен как Open Source), оптимизировать промпты под задачу.

---

## 8) Частые ошибки и как их исправить
1. **`key.txt` не найден** в ноутбуке → проверьте путь: файл должен лежать **в корне вашей рабочей области** (обычно `work/`).
2. **Длина ключа ≠ 32** → пересоздайте через `echo -n … | md5sum | cut -c -32 > key.txt`.
3. **`./test.sh` не запускается** → выполните `chmod +x test.sh` и запускайте как `./test.sh` (с `./`).
4. **Пустой/странный ответ от API** → проверьте кавычки во 2‑м аргументе, корректность `host`, и что 3‑й аргумент действительно равен `$(cat key.txt)`.
5. **Автогенерация промптов не сработала** → добавьте в описание бота больше контекста и попробуйте ещё раз.

---

## 9) Дополнительные идеи для самостоятельной работы
- Сгенерировать и сравнить 3 варианта промптов (prefix/suffix/image) для вашего бота, измерить качество ответов.
- Добавить в `test.sh` опции для выбора разных моделей/маршрутов API.
- Сделать мини‑сервис: загрузка изображения → автоматический разбор и короткий отчёт (без ручного copy‑paste между разными инструментами).

---

## 10) Чек‑лист перед сдачей
- [ ] Бот создан, доступна ссылка **Share**.
- [ ] В `key.txt` корректный 32‑символьный ключ.
- [ ] Ноутбук успешно выводит «API key loaded».
- [ ] `./test.sh … "$(cat key.txt)"` возвращает валидный JSON.
- [ ] Краткий отчёт о проделанных шагах (1–2 страницы) оформлен и приложен.

---

### Приложение A. Быстрые команды из урока
```bash
# базовые
uname -a
ls -l
pwd
cd work

# key.txt (вариант через cut)
echo -n edu | md5sum | cut -c -32 > key.txt

# проверка ключа
wc -c key.txt   # должно быть 33 байта (32 символа + перевод строки)
cat key.txt

# права и запуск скрипта
chmod +x test.sh
./test.sh ai.api.hue.com "Hi" "$(cat key.txt)"

# подстановка даты во второй аргумент
./test.sh ai.api.hue.com "now is $(date). How are you?" "$(cat key.txt)"
```